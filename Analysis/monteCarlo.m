clear all;
%% Constants
fingerLengths = [1,1.5,2,2.5,3,3.5,4];

numFingers = length(fingerLengths);
numInputs = 7;
numInputsMC = 44;
inVals = 4;
outVals = 2;

gndX = [918.9654,816.8962,794.6936088,829.1348839,739.8234879,836.8668941,816.5539935, 1117.539599];
gndY = [567.6915,725.2122,599.9239502,597.5074008,657.3000987,640.4734852,582.1009028, 391.5463097];
vmaxY = [1524.017683,1630.715,1514.129143,1597.242042,1518.573873,1565.794107,1628.058191, 791.3602242];
hmaxX = [223.7893839,152.5423,150.0800755,112.9402521,123.2098947,161.0409815,60.71429729, 738.2390954];

gndXMC = [863.2567325 901.8083771 1164.898754 1112.726592 1142.702652 761.9906006 772.0089335];
gndYMC = [747.2522311 705.9335866 399.9712973 428.492739 409.0199494 752.4487305 852.6002284];
hmaxXMC = [191.8153081 190.5690808 769.8081098 764.483474 743.0124714 149.7718964 110.4062834];
vmaxYMC = [1671.574016 1691.552667 943.7175026 898.8940202 961.6123157 1612.881348 1798.53582];

distToX = 150;
distToY = 190;
%% Excursions for each activation set for each finger

excursionRaw = [[2.5932	1.4933	1.0331	0.3152
0.4395	0.3682	0.4625	1.4128
0	0.6788	0.1427	1.6314
0.8145	0	0	-0.3359
-0.0023	1.3185	0	-0.0023
0	0	0.4832	0
-0.0989	0	0	1.9719];
    [2.9844	1.2241	1.1528	0.2738
0.4004	0.3221	0.474	1.3438
-0.0138	0.6121	0.0828	1.8385
0.8376	0	0	-0.3682
0	1.1321	0	-0.0092
0	0	0.497	0
-0.3958	-0.0023	0	2.2089];
    [2.6875	0.9135	0.8307	0.1104
0.5983	0.1795	0.3474	1.1137
-0.0207	0.4648	0	1.4772
1.0769	0	0	-0.3797
0	1.0101	0	0
0	0	0.5706	0
-0.3451	0	0	1.6222];
    [1.9926	0.9158	0.6443	0.1864
0.428	0.283	0.3382	1.0308
-0.0092	0.497	0.0184	1.728
0.6857	0	0	-0.3106
0	1.07	0	-0.023
0	0	0.4257	-0.0023
-0.3843	0	0	2.0548];
    [1.7879	0.8629	0.7363	0.2186
0.4142	0.3198	0.4487	1.2793
-0.0644	0.497	0.0851	1.9765
0.711	-0.0046	0	-0.3359
0	0.9089	0	0
0	0	0.4556	0
0	0	0	2.3286];
    [1.8385	0.8813	0.3313	0.0299
0.4556	0.2462	0.2071	1.0377
-0.0805	0.4809	0	1.514
0.6903	0	0	-0.2853
0	1.099	0	-0.0046
0	0	0.3313	-0.0023
-0.5706	0	0	1.781];
    [0.9206	0.6098	0.2784	0.2692
0.3866	0.1818	0.1496	0.6719
0	0.3359	0	1.0124
0.4188	0	0	0
0	0.78	0	0
0	0	0.3451	0
-0.0989	0	-0.0092	1.1114]; 
[0	0	0	0
1.0953	0.8191	1.7994	0.474
0.4165	0.6742	0.4602	0.7087
0	0	0	0
1.1942	-0.1404	0.0046	-0.0621
0	0	0	0
-0.5568	1.353	0.306	0.214]];

excursionRawMC = [[1.6222	2.3033	3.7483	3.0879
1.422	1.2908	3.4469	3.3778
0.4395	0.2117	2.2273	3.2375
1.3944	2.1169	2.0709	4.2982
1.6659	2.8164	3.9209	4.0336
0.283	2.4505	0.6719	4.0681
0.0828	1.4381	3.9485	3.7874
-0.0069	0.1427	0.3428	0.6972
0	2.4344	1.5532	0.665
0.1173	1.231	1.7165	2.2181
0.0138	0.0713	1.2333	2.1376
2.0824	3.7966	4.1671	0.5062
0	0.1657	0.925	3.4929
0.4096	2.1951	0.7501	3.1362
0.6995	1.7717	1.4795	3.8288
1.1528	0.5983	1.6107	0.0506
1.5624	1.1229	2.3884	4.075
0.3682	0	2.2688	3.6977
1.0308	0.2945	2.2296	4.1464
0.214	0.0368	0	0
1.0124	0	0	0.4671
0.2945	0.2071	0.5292	2.9429
1.3875	2.4022	0.6742	0.2416
0	1.5163	1.3622	1.4404
0	1.0792	2.9061	1.613
1.5255	2.8854	3.6908	4.5858
0.0345	1.2793	0.5446	2.8256
0.0276	0.2853	0	0.0506
0.3889	1.7833	2.1537	3.3272
0.8468	1.5739	2.4804	0.8698
0.8951	0.2071	0	1.8914
0.0115	0.1726	0.826	0.5729
0.826	2.5518	1.0653	3.8564
0	0.0368	0.0207	0.0621
0.5453	0.1266	0.8168	1.1574
0.9687	1.5831	3.3042	3.5113
0.7087	0.4901	0.3935	3.0281
0	0	0.0391	0.9917
1.1873	2.3953	2.6277	0.4556
0.2255	2.018	1.2172	0.6604
1.5831	1.6866	2.1054	3.4584
0.3474	1.1482	0.6696	2.9729
0.1703	0	0	2.1353
1.0976	1.1689	1.6038	1.2701];
    [1.4243	2.4344	3.5366	2.2642
1.1022	1.3047	3.0787	2.3125
0.2117	0.3152	1.781	2.3033
1.0561	1.942	1.682	2.7197
1.4036	2.8095	3.3594	2.5173
0.0391	2.515	0.6673	2.7128
0.0092	1.4473	3.0902	2.6254
0	0.2853	0.4602	0.4211
0	2.6234	1.4657	0.5361
0.1012	1.2586	1.4496	1.6176
0.0391	0.1657	1.185	1.6498
1.7487	3.5251	3.6539	0.3682
-0.0805	0.1588	0.826	2.8831
0.2784	2.1997	0.7823	2.2043
0.3889	1.7188	1.2425	2.9567
1.063	0.6443	1.3875	0.0345
1.2793	1.1022	2.041	2.9913
0.1266	0	1.7717	2.5219
0.7662	0.3267	1.7119	2.6484
0.1473	0.0713	0	0
0.8283	0	0	0.3543
0.1795	0.1887	0.5453	2.2043
1.2103	2.2964	0.6765	0.2071
0	1.537	1.3162	1.1735
0	1.0792	2.5311	1.2057
1.307	2.8141	3.3318	3.1983
0	1.4059	0.5154	2.0801
0.0092	0.306	0	0.0322
0.1749	1.728	1.8431	2.752
0.6696	1.5992	2.0203	0.6328
0.6765	0.2301	0.0138	1.1735
0.0184	0.2301	0.8813	0.497
0.5683	2.439	1.0792	3.1109
0	0.0506	0.0736	0.0483
0.405	0.1081	0.8422	0.8721
0.7248	1.5486	2.7658	2.8969
0.4556	0.4878	0.405	2.1077
0	0	0.069	0.711
1.017	2.4528	2.3125	0.405
0.122	2.1652	1.1827	0.5775
1.3461	1.774	1.8707	2.4873
0.1035	1.0861	0.6512	2.4367
0.1104	0	0	1.5785
0.9227	1.1551	1.468	0.9227];
    [1.4174	1.2747	2.7151	1.4841
1.2287	0.5591	2.515	1.4703
0.3152	0.0437	1.7119	1.682
1.1091	1.1321	1.1873	2.3401
1.4749	1.5393	2.699	1.7602
0.1035	1.6015	0.3014	2.1744
0	0.7754	2.6852	1.9742
0	0.1266	0.3935	0.3014
0	1.6337	1.0838	0.2853
0.0506	0.8951	1.3346	1.0792
0.0115	0.0138	1.2379	1.1781
1.5347	2.248	2.9867	0.1035
0	0.0391	0.619	2.2503
0.3083	1.4082	0.3958	1.7533
0.4533	1.1666	0.8122	2.439
1.2057	0.3843	1.517	0
1.4634	0.5476	1.6797	2.3309
0.2968	0	1.6245	2.0502
0.8191	0.0736	1.4496	2.2573
0.295	0.0046	0	0
1.0653	0	0	0.3336
0.2738	0.0322	0.3728	1.9535
1.2862	1.399	0.4142	0.122
0	1.0538	1.0999	0.7524
0	0.688	2.439	0.7133
1.1896	1.7257	2.5564	2.5426
0.0023	0.9503	0.2623	1.5555
0.0299	0.2784	0	0.0299
0.1795	1.0584	1.5025	2.1813
0.7409	0.925	2.0157	0.3474
0.879	0.1841	0.0046	0.9848
0.0046	0.1058	0.9181	0.3221
0.6213	1.6153	0.5752	2.7566
0	0.0736	0.0759	0.0345
0.6213	0.0138	0.7662	0.6121
0.7616	0.7915	2.3493	2.2987
0.7156	0.2554	0.2232	1.9443
0	0	0.0805	0.6121
1.0423	1.4197	2.1031	0.1565
0.1795	1.4381	0.9227	0.3313
1.3967	1.1896	1.5002	2.0318
0.2462	0.7294	0.4119	2.0525
0.1404	0	0	1.3323
1.0009	0.688	1.4404	0.6558];
    [1.1413	1.5923	2.6461	1.5048
1.0239	0.9572	2.6691	1.5877
0.3336	0.2347	1.8316	1.8201
0.9411	1.4703	1.4772	2.1721
1.162	1.9259	2.7082	1.7856
0.0851	2.0157	0.6489	2.301
0.0414	1.0147	2.6231	2.0962
0	0.3221	0.6121	0.3797
0	1.8868	1.2126	0.3866
0.1726	1.07	1.4864	1.2517
0.0874	0.1657	1.2908	1.3047
1.3208	2.3539	2.8946	0.1818
-0.0506	0.2002	0.8583	2.4735
0.3428	1.7188	0.6742	1.6314
0.4487	1.3691	1.0308	2.4137
1.0216	0.6673	1.491	0.0092
1.1252	0.8283	1.728	2.2388
0.2393	0	1.6061	2.2204
0.7294	0.2347	1.5347	2.1813
0.237	0.1012	0	0
0.8307	0	0	0.2922
0.2692	0.0782	0.4924	2.1261
1.017	1.7533	0.6282	0.1243
0	1.2632	1.2034	0.803
0.0276	0.9503	2.11	0.8307
1.07	1.9742	2.7105	2.3516
0.0069	1.3185	0.566	1.7971
0.0506	0.3751	0	0.0276
0.2163	1.3139	1.636	2.1836
0.7432	1.2977	1.9742	0.4694
0.6788	0.3129	0.1104	1.0446
0.1127	0.2416	0.9986	0.3866
0.5614	1.8408	0.8721	2.4597
0	0.1312	0.1312	0.0483
0.5338	0.1427	0.8468	0.6397
0.6949	1.04	2.1261	2.1882
0.5453	0.4464	0.4556	2.1192
0.0069	0	0.092	0.5775
0.9641	1.6383	1.8523	0.2347
0.2002	1.7142	1.093	0.4027
1.1505	1.3507	1.6015	1.8293
0.1864	0.9572	0.6328	2.248
0.1818	0	0	1.4611
0.9296	0.9135	1.4197	0.7225];
    [0.9848	1.5601	2.332	2.3424
0.9457	0.9549	2.3677	2.6162
0.3912	0.2531	1.6935	2.8095
0.8399	1.5324	1.4243	3.3433
1.0538	1.873	2.3286	3.012
0.2278	2.0686	0.8399	3.6539
0.0736	1.1459	2.4758	3.4353
0	0.306	0.5522	1.0032
0	1.6935	1.0584	0.856
0.1519	1.162	1.3438	2.1905
0.1358	0.1933	1.1666	2.2503
1.1022	2.248	2.2918	0.5752
-0.0529	0.382	1.0078	3.0603
0.3959	1.774	0.8145	2.9038
0.4579	1.5025	1.1827	3.578
0.9319	0.5154	1.2609	0.1266
0.8168	0.8491	1.7142	3.3548
0.3705	0	1.5877	3.2214
0.7271	0.2623	1.567	3.4837
0.4165	0.0828	0.0023	0.0023
0.6811	0	0	0.359
0.2485	0.2278	0.6328	2.8601
0.9595	1.544	0.6167	0.2876
0	1.2632	1.2103	1.4933
0.0322	0.8537	1.8638	1.6705
0.7478	1.9144	2.3309	3.7069
0.1104	1.376	0.6834	3.081
0.1012	0.2945	0	0.1289
0.1726	1.3254	1.5071	3.2237
0.6949	1.1988	1.7303	1.0469
0.6604	0.3935	0.2554	1.6291
0.1611	0.2416	0.9687	0.6719
0.4786	1.8661	0.9825	3.4722
0	0.1404	0.122	0.1749
0.5867	0.1473	0.7961	1.0285
0.5798	1.093	2.0548	3.1316
0.5246	0.5683	0.5913	3.1017
0.069	0.0046	0.2163	1.1206
0.7892	1.4703	0.1659	0.5476
0.1726	1.6636	1.0746	0.8997
0.925	1.4565	1.5578	2.8325
0.3428	1.0446	0.757	3.0649
0.1772	0	0.0345	2.416
0.9066	0.9135	1.3392	1.1643];
    [0.994	1.1091	1.9558	1.1735
0.9181	0.6581	2.4781	1.3852
0.3543	0.0713	2.0801	1.5831
0.8283	0.9595	1.4105	1.942
1.093	1.4358	2.0893	1.4358
0.1381	1.7188	0.7133	2.4321
0.0805	0.9917	1.9259	1.682
0	0.2876	1.1252	0.4188
0	1.4174	0.9618	0.2531
0.1956	1.1045	1.2724	0.9733
0.1058	0.115	1.2747	1.1344
1.0953	1.6268	2.1629	-0.1519
-0.2623	0.2002	1.185	2.4574
0.5522	1.3691	0.4947	1.5232
0.3543	1.3668	0.7432	2.255
0.9779	0.6972	1.3047	-0.0391
0.9227	0.5062	1.4979	1.9098
0.2301	0	1.5555	2.1951
0.5683	0.0414	1.5209	2.2296
0.3198	0.0644	0.1012	0
0.7018	0	0	0.3221
0.1657	0.0092	0.4464	2.2204
1.017	1.2517	0.3866	0.0529
0	1.1574	0.971	0.665
0.0391	0.7961	1.7372	0.665
0.8145	1.3438	2.3125	1.8155
0.0644	1.2448	0.7432	1.8086
0.122	0.6351	0	0.0368
0.1703	0.9411	1.2333	1.774
0.6972	1.1505	1.7188	0.3889
0.6167	0.352	0.2807	1.0285
0.1565	0.1197	0.994	0.352
0.4188	1.2862	0.5476	2.1169
0	0.6029	0.1841	0.0644
0.5338	0.0644	0.7593	0.5798
0.5752	0.6305	1.5969	1.6981
0.4855	0.3797	0.6282	1.9972
0.0368	0	0.1404	0.6351
0.8237	1.1229	1.4358	0.092
0.3014	1.514	1.1068	0.3751
0.948	1.2954	1.2678	1.5163
0.2255	0.9342	0.5775	2.1146
0.1611	0.0184	0	1.5347
0.8491	0.7593	1.185	0.6052];
    [0.3382	0.4786	1.055	0.451
0.2876	0.069	1.3944	0.5844
0.0529	0	1.2402	0.7064
0.3359	0.4326	0.6742	0.8353
0.428	0.6857	1.0584	0.7018
0	0.8468	0.1818	1.0239
0	0.4418	1.0976	0.8076
0	0.0184	0.6489	0.3106
0	0.7892	0.3797	0.0437
0	0.589	0.5085	0.3797
0	0	0.5798	0.4878
0.3198	0.8652	1.185	0.0023
-0.1657	0.0184	0.6213	0.9043
0.1795	0.8744	0.069	0.711
0.115	0.7225	0.1335	0.9549
0.3543	0.2117	0.5246	0.0575
0.3843	0.0069	0.6489	0.8145
0.0943	-0.0069	0.7593	0.9733
0.2807	0	0.7409	0.9748
0.1611	0	0.0207	0.0575
0.3543	0	0	0.2692
0.1127	0	0.1565	0.8399
0.4165	0.7064	0.0552	0.0989
0	0.6696	0.3705	0.3014
0	0.2623	0.9089	0.2393
0.2508	0.6075	1.3323	0.6512
0	0.6604	0.3014	0.9273
0.0115	0.352	0	0.0828
0	0.4625	0.4694	0.6719
0.1634	0.5545	0.8537	0.1979
0.2669	0.1081	0.0138	0.5131
0	0	0.6006	0.1657
0.2002	0.7087	0.0667	0.7386
0	0.3129	0.0161	0.2071
0.1956	0	0.3244	0.2347
0.168	0.0989	0.757	0.6765
0.2393	0.0161	0.2324	1.0032
0.0115	0	0.0092	0.4901
0.2577	0.5967	0.6627	0.0092
0.0092	0.8491	0.4671	0.1104
0.3751	0.6581	0.4648	0.5867
0.0828	0.4556	0.0805	0.9572
0.092	0	0	0.8214
0.3037	0.3359	0.4694	0.2991]];

excursions = zeros(numInputs, inVals, numFingers);
for i = 1:numFingers
    excursions(:,:,i) = excursionRaw((i-1)*numInputs+1:i*numInputs,:);
end

excursionsMC = zeros(numInputsMC, inVals, numFingers);
for i = 1:numFingers
    excursionsMC(:,:,i) = excursionRawMC((i-1)*numInputsMC+1:i*numInputsMC,:);
end
%% End point pixels for each activation set for each finger
epRaw = [[633.8326502	914.9313833
778.118032	1062.366599
825.2189951	1079.006116
732.3635097	1028.127291
737.0398755	1046.145901
776.034145	1073.185343
783.7559838	1073.975915];
    [672.3688369	1201.094438
679.5587811	1183.134894
617.0902238	1173.147943
556.40325	1129.045921
552.266634	1152.913343
576.8147681	1166.302795
809.9210453	1206.557562];
    [711.532262	1050.006738
647.8657802	1034.641506
677.6527166	1030.752991
583.0524733	974.6021743
601.9872088	1021.254593
630.203197	1031.720516
675.261503	1029.984747];
    [699.7176323	1125.501882
639.3820643	1104.924038
799.5235248	1116.754747
641.7167661	1088.626649
628.1581769	1099.914369
605.6430819	1099.712669
850.1396779	1125.200569];
    [518.0555052	1152.77918
500.7249311	1154.872231
718.6654644	1190.628051
450.9932293	1113.641085
467.0814575	1132.783539
479.4100494	1145.137884
481.0628841	1146.117712];
    [502.6379809	1094.056621
607.5492206	1196.226269
782.4396107	1227.827124
559.7503817	1151.960564
558.3174992	1168.773043
594.7681932	1187.191237
603.5666616	1193.270175];
    [148.9018815	741.9566164
165.0153595	807.587358
160.6604048	784.9443405
151.3067601	749.2579052
152.6506145	765.6880049
156.5239658	771.2519007
169.7112298	811.9781573];
    [992.1306973	660.757953
992.0155072	658.7463562
1170.883734	692.3837476
904.3682256	612.3627939
1060.294748	702.0648992
931.3027838	631.8308597
930.5279186	630.3975649]];

epRawMC = [[679.4182593	1179.83101
786.8971969	1148.777785
818.1844547	1171.072949
657.8703127	1166.897016
759.6044371	1129.484311
829.5158319	1173.28652
810.1801209	1157.465143
723.4202588	1183.671025
661.976902	1166.162275
771.8061312	1184.597505
654.3478713	1161.700416
509.7134994	881.4154389
629.4015913	1143.543601
820.7339521	1184.932137
833.6209831	1169.875299
663.7995687	1166.663815
833.6114902	1156.347358
842.1400399	1168.887581
666.2882098	1172.712841
667.4441966	1172.753947
680.3444451	1179.274665
691.3705009	1185.249152
561.3987136	1083.02397
665.2945427	1178.393386
725.8422933	1161.431783
771.8646279	1132.430799
826.6894541	1187.184879
676.8274965	1174.803077
820.7760946	1173.627933
619.6489394	1095.640879
798.5016155	1192.435143
736.4553037	1186.273773
676.8499851	1178.35297
692.6577438	1183.719122
686.7355013	1183.699444
821.0551667	1164.499268
676.8581574	1170.554481
809.0422053	1204.656136
710.7220008	1190.227967
653.9607716	1159.804148
787.3556421	1158.40264
683.5072539	1172.911411
830.8294439	1193.79982
709.4820535	1162.453465];
    [627.0767497	1105.776196
696.2319038	1132.113153
830.3279386	1165.745502
808.4966936	1155.928647
661.608043	1104.286931
645.8471066	1147.037411
663.5827291	1156.255862
692.1388445	1162.91632
571.2001252	1096.98169
692.9203672	1170.485092
755.2534671	1184.731013
187.8366191	699.8378421
844.066226	1188.357269
648.6867023	1157.140472
645.064855	1157.972943
669.0992683	1161.128449
629.7948009	1148.58486
676.8995992	1157.526788
860.8712111	1156.505924
693.943025	1156.685646
669.8049097	1140.517397
665.2829175	1157.883079
541.9971452	1074.365083
676.9733032	1166.047855
662.034152	1154.00376
696.2788382	1124.53873
827.2451696	1186.53455
644.4581583	1154.747244
839.8913451	1181.965971
583.4164152	1099.061564
713.985673	1173.496339
670.968581	1163.915138
835.2194266	1175.420175
656.2869489	1160.521764
661.9296787	1163.59115
825.1678581	1165.940504
675.5788666	1157.649715
771.6711222	1183.788076
530.9755157	1055.492466
605.3504945	1140.977694
688.2027164	1144.079568
842.0810442	1183.864092
664.7800851	1163.531848
660.9650577	1146.142196];
    [1005.125716	647.2816542
1017.636279	639.8490548
1086.24529	660.7812517
1075.581911	651.3780746
1016.168594	631.9673982
1019.931393	655.5757303
1096.579708	662.4154804
1029.747474	659.2626236
975.79287	635.2273321
1027.403022	660.4861432
1059.678889	668.4644784
903.0310464	555.8900909
993.2213812	651.976162
1074.3357	667.8598919
1010.057322	654.9400353
956.1439718	610.9225357
1058.409814	646.9782293
1130.555348	658.598282
1033.61749	656.5851333
1043.497705	656.3546834
1029.132941	656.0875823
1022.889246	654.3024282
965.7424679	615.9814119
1018.305696	657.1463046
996.9424725	647.7688146
1026.793866	640.9805155
1103.839259	669.8348174
1009.40355	655.3088779
1091.065005	667.6773101
965.2829113	621.9226761
1034.139142	652.4483322
1008.833898	654.8036928
1081.319625	663.4447043
1020.913535	655.4286578
1019.666224	650.1868799
1073.738422	653.0801754
1126.642681	657.2662101
1043.876815	659.0859101
953.0551929	606.3653169
1003.822784	652.3028992
1015.946666	639.6715608
1126.241298	664.1604824
1108.867396	665.1778984
1008.561358	639.2777598];
    [1014.335218	643.5774243
1017.154371	647.9005771
1074.507814	646.431088
1025.374384	650.246133
1016.940316	625.7153888
1097.813737	642.8728549
1083.675334	643.1293615
1046.307315	651.2719447
996.9984921	644.0617735
1044.61391	655.3220959
1074.098992	656.0449233
1021.1751	654.9734726
1095.098469	651.0919633
1032.880959	655.7413044
1097.894454	641.2977848
1047.330695	652.0417009
1030.96179	652.5803832
1099.001132	638.1998436
1043.755566	650.0026411
1046.083156	648.2279077
1018.64346	634.249673
1099.339101	642.0597315
982.8332341	624.694165
1037.561762	654.5832763
1011.329851	644.5594827
1032.485837	632.1090341
1094.081727	649.9493864
1034.517623	652.8579155
1090.722311	647.3740311
979.0831618	627.2620165
1042.571506	645.6700642
1024.166629	651.2913283
1097.377625	640.2949893
1045.091488	653.8250256
1044.894947	646.52349
1078.73022	640.1984668
1099.85669	634.423265
1051.159769	650.607056
962.1847166	617.786267
993.9759102	643.464555
1029.532545	633.8737361
1099.048219	642.8179865
1098.759277	643.838674
1011.696078	636.7580963];
    [1041.149559	706.2537475
943.4897357	695.3187575
943.038753	694.2800093
1126.226495	709.250468
943.8521947	694.7801886
934.7944841	691.4530759
934.7549279	692.3265075
991.1286048	714.6424832
963.7952175	697.2877083
1071.211089	729.8434401
1089.479162	722.9607607
942.9364476	694.0090055
1138.584653	726.7511039
952.7048159	698.8709059
942.2294261	694.8802824
911.2653713	657.9831352
1121.51946	708.2417582
961.6145589	699.5453367
940.8996823	693.7338877
937.0885825	688.5466456
945.0038493	687.0106959
955.8627248	697.1988387
919.5170178	668.0394101
1024.303961	719.3915515
1039.27491	721.8545504
1107.976571	711.4043329
1131.979259	722.8460209
940.8626652	693.8634205
941.0320199	693.6264715
966.9343603	690.93024
1025.691793	714.1231737
990.8192856	711.0768428
1133.406831	711.9314282
956.002444	701.6125929
960.9805191	699.8557482
950.4631538	699.3544493
1137.128833	713.5419979
1045.737374	727.5725126
937.2245817	673.2250299
964.3309986	698.4220934
1073.850521	717.0158038
1139.935244	719.8311582
945.2574333	695.1020393
995.2333469	704.9370604];
    [493.8282166	1232.923584
563.0811157	1232.900757
676.1222534	1247.853027
593.3629761	1262.470703
392.402771	1152.836182
417.0895386	1182.078369
466.5465393	1215.095825
662.2710571	1255.324707
651.0400391	1262.000854
465.2622375	1198.630005
463.2017822	1189.647949
493.6435242	1205.762573
593.920166	1248.112549
492.3773804	1228.216431
495.7711792	1205.678101
486.9734497	1232.574829
626.9321899	1252.858154
530.0609741	1244.105225
449.2824707	1203.438477
526.3134155	1236.846924
558.6228027	1246.874634
317.1812744	1074.802368
729.0975952	1270.317383
514.4732056	1249.036621
500.4654846	1234.478271
396.624176	1152.540405
565.5140381	1221.657715
494.4562988	1235.789429
497.376709	1233.755493
480.4256897	1220.426025
463.1335754	1199.899658
480.7573242	1227.442017
396.1946411	1153.180054
469.1153259	1217.356201
480.0827332	1219.150757
511.1854858	1213.340454
633.3457642	1262.333984
494.2642212	1235.31958
609.5808716	1249.321045
495.0969849	1234.61499
522.7298584	1226.408325
480.7310486	1220.731445
598.4604492	1239.175537
495.8258057	1233.759766];
    [142.9920025	975.8770566
146.8388722	992.4390454
156.575418	1029.561855
156.7954845	1012.492989
144.6437073	969.8776874
164.6736721	1044.283393
161.8065701	1043.24212
154.5901005	1016.790054
141.0777736	973.8860159
153.1137004	1009.461617
158.5524049	1033.877662
136.1195717	933.8918571
187.2456231	1102.126369
163.8842582	1046.393359
172.1532769	1063.086603
139.9454508	957.7152767
148.5336102	996.3689309
149.8032136	1007.385463
165.745586	1045.72188
145.6426625	994.0934017
148.2355468	1000.17347
151.250237	1008.038037
138.2910357	944.0547032
144.6008234	991.3801937
144.1072159	991.3249545
146.3296456	984.7764688
162.3697686	1041.104995
148.6323748	1001.224623
162.5873008	1035.534029
140.0370889	966.8831558
158.8034472	1020.012512
153.6950368	1013.706914
158.2819262	1027.227379
151.1782777	1008.378082
149.3756491	1001.053953
153.3224638	1010.057518
175.766715	1066.412283
163.9129193	1048.306581
140.4540992	958.4517016
150.8665597	1007.488813
148.1887633	992.4889987
170.13783	1054.573524
175.0693903	1069.669252
147.1344028	987.1777534]];

epPix = zeros(numInputs, outVals, numFingers);
for i = 1:numFingers
    epPix(:,:,i) = epRaw((i-1)*numInputs+1:i*numInputs,:); 
end

epPixMC = zeros(numInputsMC, outVals, numFingers);
for i = 1:numFingers
    epPixMC(:,:,i) = epRawMC((i-1)*numInputsMC+1:i*numInputsMC,:); 
end
%% Information for the resting position locations in pixels
restingPixels = [770.0054702	1063.307148; %1cm
                588.2572567	1158.489664; %1.5cm
                643.9360087	1030.747186; %2cm
                641.1594024	1101.594728; %2.5cm
                498.1596167	1146.664351; %3cm
                504.1842092	1094.243785; %3.5cm
                159.0408108	787.194775;  %4cm
                946.1466951	642.4832218];  %Hard finger
            
restingPixelsMC = [657.7556937	1160.804777; %1cm
                645.7346904	1155.524502; %1.5cm
                991.5714507	623.7281294; %2cm
                1015.15517	648.5336671; %2.5cm
                1038.132617	708.9712263; %3cm
                491.8841248	1233.859253; %3.5cm
                148.9194236	1001.881721];  %4cm
%% determine X and Y coordinates of each excursion set for each finger

xyMC = zeros(numInputsMC, outVals, numFingers);
xy = zeros(numInputs, outVals, numFingers);

for a = 1:numFingers
    for b = 1:numInputs
        epX = epPix(b, 1, a);
        epY = epPix(b, 2, a);
        x = ((gndX(a)-epX)/(gndX(a)-hmaxX(a)))*distToX;
        y = ((epY-gndY(a))/(gndY(a)-vmaxY(a)))*distToY;
        if a == 8
            y = ((epY-gndY(a))/(gndY(a)-vmaxY(a)))*(distToY-27);
        end
        xy(b,1,a) = x;
        xy(b,2,a) = y;
    end
end
for a = 1:numFingers
    for b = 1:numInputsMC
        epX = epPixMC(b, 1, a);
        epY = epPixMC(b, 2, a);
        x = ((gndXMC(a)-epX)/(gndXMC(a)-hmaxXMC(a)))*distToX;
        y = ((epY-gndYMC(a))/(gndYMC(a)-vmaxYMC(a)))*distToY;
        if a == 8
            y = ((epY-gndYMC(a))/(gndYMC(a)-vmaxYMC(a)))*(distToY-27);
        end
        xyMC(b,1,a) = x;
        xyMC(b,2,a) = y;
    end
end
%% Calculate the X and Y coordinates of the endpoint at the resting position
restingXY = [0,0;
    0,0;
    0,0;
    0,0;
    0,0;
    0,0;
    0,0;];
restingXYMC = [0,0;
    0,0;
    0,0;
    0,0;
    0,0;
    0,0;
    0,0;];

for a = 1:numFingers
    restingXY(a,1) = ((gndX(a)-restingPixels(a,1))/(gndX(a)-hmaxX(a)))*distToX;
    restingXY(a,2) = ((restingPixels(a,2)-gndY(a))/(gndY(a)-vmaxY(a)))*distToY;
end
for a = 1:numFingers
    restingXYMC(a,1) = ((gndXMC(a)-restingPixelsMC(a,1))/(gndXMC(a)-hmaxXMC(a)))*distToX;
    restingXYMC(a,2) = ((restingPixelsMC(a,2)-gndY(a))/(gndYMC(a)-vmaxYMC(a)))*distToY;
end
restingXY;
%% Calculate difference in distance from the reference position
difXY = zeros(numInputs, outVals, numFingers);
for a = 1:numFingers
    for b = 1:numInputs
        difXY(b,1, a) = xy(b, 1, a)-restingXY(a,1);
        difXY(b,2, a) = xy(b, 2, a)-restingXY(a,2);
    end
end
difXYMC = zeros(numInputsMC, outVals, numFingers);
for a = 1:numFingers
    for b = 1:numInputsMC
        difXYMC(b,1, a) = xyMC(b, 1, a)-restingXYMC(a,1);
        difXYMC(b,2, a) = xyMC(b, 2, a)-restingXYMC(a,2);
    end
end
difXYMC;
%% Compare these values to what would be expected from the matrices calculated from the 7 postures
% linear regression of the postures
linRegress = zeros(inVals,outVals,numFingers);
for a = 1: numFingers
    linRegress(:,:,a) = excursionsMC(:,:,a)\difXYMC(:,:,a);
end
linRegress;
%% calculate expected points based of the linear regressions and the excursion values for each finger
yCalc = zeros(numInputsMC,outVals,numFingers);
for a=1:numFingers
    yCalc(:,:,a) = excursionsMC(:,:,a)*linRegress(:,:,a);
end
yCalc;
for b=1:numFingers
    figure(b)
    hold on
    calc = scatter(yCalc(:, 1, b), yCalc(:,2,b));
    actual = scatter(difXYMC(:, 1, b), difXYMC(:,2,b));
    calc.LineWidth = 0.3;
    calc.MarkerFaceColor = [1 0 0];
    actual.LineWidth = 0.3;
    actual.MarkerFaceColor = [0 0 1];
    for a=1:numInputsMC
        plot([difXYMC(a,1,b), yCalc(a, 1, b)], [difXYMC(a,2,b), yCalc(a,2,b)])
    end
    title_plot = strcat("Calculated dX and dY versus Actual (", strcat(string(fingerLengths(b)), " cm)"));
    title(title_plot)
    xlabel("Delta X")
    ylabel("Delta Y")
    hold off
end
%% R^2
rtsq = zeros(numFingers,1);
for a=1:numFingers
    [R,P] = corrcoef(difXYMC(:,:,a), yCalc(:,:,a));
    rtsq(a) = R(2,1);
end
rtsq = (rtsq.^2)